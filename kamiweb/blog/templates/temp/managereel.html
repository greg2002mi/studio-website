{% extends "base-admin.html" %}
{% load i18n %}
{% load static %}

{% block head_js %}
<script src="{% static 'js/dropzone.min.js' %}"></script>
<link rel="stylesheet" href="{% static 'css/dropzone.min.css' %}" type="text/css" />
<link rel="stylesheet" href="{% static 'css/w3.css' %}"/>
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.css" />
<link rel="stylesheet" src="{% static '/datatables/datatables_style.css' %}"></link>

<style>
label {
    color: #555555;  /* Dark grey color */
}
<style>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.js"></script>
<style>
	.video-wrapper {
		display: flex;
		overflow-x: auto;
		overflow-y: auto;
		white-space: nowrap;
		justify-content: left;
	}
	.video-wrapper video {
		width: 9vw;
		height: 16vw;
		margin: 0;
		cursor: pointer;
		display: inline-block;
	}
	.modal {
		display: none;
		position: fixed;
		z-index: 1050;
		left: 0;
		top: 0px;
		width: 100%;
		height: 100%;
		overflow: auto;
		background-color: rgb(0, 0, 0);
		background-color: rgba(0, 0, 0, 0.9);
		justify-content: center;
		align-items: center;
	}
	.modal-content {
		margin: auto;
		display: block;
		max-width: 80%;
		height: auto;
		position:relative;
	}
	.close {
		position: absolute;
		top: 85px;
		right: 35px;
		color: #f1f1f1;
		font-size: 40px;
		font-weight: bold;
		transition: 0.3s;
	}
	.close:hover,
	.close:focus {
		color: #bbb;
		text-decoration: none;
		cursor: pointer;
	}
</style>
<script>
	$(document).ready(function() {
		var modal = document.getElementById("videoModal");
		var modalVideo = document.getElementById("modalVideo");
		var modalVideoSource = document.getElementById("modalVideoSource");
		var closeBtn = document.getElementsByClassName("close")[0];

		function adjustModalVideoHeight() {
			var windowHeight = window.innerHeight;
			var maxVideoHeight = windowHeight * 0.8; // 80% of the window height
			modalVideo.style.height = maxVideoHeight + 'px';
			modalVideo.style.width = 'auto'; // Maintain aspect ratio
		}

		// Adjust the video height when the window is resized
		window.onresize = adjustModalVideoHeight;

		// When a video thumbnail is clicked
		$('.video-thumbnail').on('click', function() {
			var videoSrc = $(this).data('video');
			modalVideoSource.src = videoSrc;
			modalVideo.load();
			modal.style.display = "flex";
			modalVideo.play();
			adjustModalVideoHeight(); // Adjust the height when the modal is shown
		});

		// When the close button is clicked
		closeBtn.onclick = function() {
			modal.style.display = "none";
			modalVideo.pause();
			modalVideo.currentTime = 0; // Reset the video to start
		}

		// When anywhere outside of the modal is clicked
		window.onclick = function(event) {
			if (event.target == modal) {
				modal.style.display = "none";
				modalVideo.pause();
				modalVideo.currentTime = 0; // Reset the video to start
			}
		}
	});
</script>	
<script>
$(document).ready(function() {
    $('#filterservice').DataTable({
        "columnDefs": [
            { "orderable": false, "targets": [] } // Disable sorting for columns 4, and 5
        ]
    });
});

</script>
{% endblock %}

{% block app_content %}
{% load crispy_forms_tags %}  

    <div class="py-vh-6 bg-gray-100 text-light w-100 overflow-hidden" id="workwithus">
      <div class="container">
			<div class="row d-flex justify-content-center text-center">
            <div class="col-lg-10 text-center" data-aos="fade">
              <p class="text-secondary lead">{% translate "Upload Reel" %}</p>		 
					 <a class="btn btn-success btn-xl shadow me-3 mt-4" data-aos="fade-down" href="{% url 'new_reel' %}">{% translate "Upload new reel" %}</a>
					 <a class="btn btn-success btn-xl shadow me-3 mt-4" data-aos="fade-down" href="{% url 'new_rcat' %}">{% translate "Create new reel category" %}</a>
				</div>	 
			</div>	


        
      </div>
    </div>
	
	<div class="py-vh-6 bg-gray-300 text-light w-100 overflow-hidden" id="workwithus">
      <div class="container">
        <div class="row d-flex justify-content-center">
          <div class="row d-flex justify-content-center text-center">
            <div class="col-lg-12 text-center" data-aos="fade">
              <!--<p class="text-secondary lead">{% translate "All publications:" %}</p>-->
              <h2 class="display-6 mb-5">{% translate "All data:" %}</h2>
            </div>
            <div class="col-12">
              <table class="table table-responsive text-nowrap" style="" id="filterservice">
				<thead>
					<tr class="table-dark">
					  <th scope="col">#</th>
					  <th scope="col">{% translate "Upload date" %}</th>
					  <th scope="col">{% translate "Title" %}</th>
					  <th scope="col">{% translate "video" %}</th>
					  <th scope="col">{% translate "Published" %}</th>
					  <th scope="col">{% translate "Category" %}</th>
					  <th scope="col">{% translate "Action" %}</th>
					</tr>
				</thead>
				<tbody>
					{% for s in reel_data %}
					<tr class="table-dark">
					  
					   <th scope="row">{{ s.id }}</th>
					  <td>{{ s.created_on }}</td>
					  <td>{{ s.title | truncatechars:20 }}</td>
					  <td><div class="video-wrapper"><video class="video-thumbnail" data-video="{{s.video}}">
								<source src="{{s.video}}" type="video/mp4">
								Your browser does not support the video tag.
							</video></div></td>
					  <td>{{ s.published }}</td>
					  <td>{{ s.category }}</td>
					  <td><a class="btn btn-success btn-sm" href="{% url 'edit_reel' entry=s.id %}" role="button">{% translate "Edit" %}</a>
					      <a class="btn btn-danger btn-sm" href="{% url 'delete_reel' entry=s.id %}" role="button">{% translate "Delete" %}</a>
					  </td>
					</tr>
					{% endfor %}
				</tbody>
			  </table>
            </div>
          </div>

        </div>
      </div>
    </div>
 

	
	<div id="videoModal" class="modal">
		<span class="close">&times;</span>
		<video class="modal-content" id="modalVideo" controls>
			<source id="modalVideoSource" src="" type="video/mp4">
			Your browser does not support the video tag.
		</video>
	</div>


  {% endblock %}